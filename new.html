<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ø£Ø­Ø¯Ø« Ø­Ù„Ù‚Ø§Øª</title>
    <link rel="stylesheet" href="/CSS/style.css" />
    <script src="navbar.js" defer></script>
    <link rel="icon" href="https://abdo12249.github.io/1/navbar/favicon.ico" type="image/x-icon" />

    <!-- Firebase SDKs -->
<!-- Firebase SDK v9 (Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ) -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>


    <style>
        /* Pagination styling for the navigation buttons */
        .pagination {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin: 20px 0;
        }
        .pagination button {
            padding: 6px 12px;
            background-color: var(--primary-color, #ef4444);
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.3s ease; /* Smooth transition for hover effects */
        }
        .pagination button:hover {
            background-color: #dc2626; /* Slightly darker on hover */
        }
        .pagination button.active {
            background-color: #b91c1c; /* Active button color */
        }
        .pagination span {
            padding: 6px 12px;
            color: #888;
        }

        /* Loading overlay styles */
        .loading-overlay {
            position: fixed; /* Fixed position to cover the entire viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black background */
            display: flex; /* Use flexbox for centering content */
            flex-direction: column; /* Stack items vertically */
            justify-content: center; /* Center vertically */
            align-items: center; /* Center horizontally */
            z-index: 1000; /* Ensure it's on top of other content */
            color: white; /* Text color */
            font-size: 1.2em; /* Larger font size for text */
        }

        /* Spinner animation */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3); /* Light border for the spinner */
            border-top: 4px solid #fff; /* White top border for animation */
            border-radius: 50%; /* Make it circular */
            width: 40px; /* Spinner width */
            height: 40px; /* Spinner height */
            animation: spin 1s linear infinite; /* Spin animation */
            margin-bottom: 15px; /* Space below the spinner */
        }

        /* Keyframes for the spin animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Anime card image loading transition */

        .anime-image img.loaded {
            opacity: 1; /* Fully visible when loaded */
        }
    </style>
</head>
<body>

<div id="navbar-container"></div>

<main>
    <div class="section-header">
        <h1>Ø£Ø­Ø¯Ø« Ø­Ù„Ù‚Ø§Øª</h1>
    </div>

<div style="max-width:100%;overflow:hidden;">
    <script type="text/javascript">
        atOptions = {
            'key' : 'fcb1605c77b3fd33d38ff238d2ffbd00',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
        };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/fcb1605c77b3fd33d38ff238d2ffbd00/invoke.js"></script>
</div>

<style>
iframe {
    max-width: 100% !important;
    height: auto !important;
}
</style>

    
    <div class="anime-grid" id="animeGrid"></div>
    <div class="pagination" id="pagination"></div>

    <!-- Loading screen overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <span>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…ÙŠ...</span>
    </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    getDocs,
    doc,
    getDoc,
    setDoc,
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

  // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
  const firebaseConfig = {
    apiKey: "AIzaSy...",
    authDomain: "your-project.firebaseapp.com",
    projectId: "your-project",
    storageBucket: "your-project.appspot.com",
    messagingSenderId: "123456",
    appId: "1:123456:web:abc",
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ
  const EPISODES_PER_PART = 500;
  const maxItemsPerPage = 20;

  let allParts = []; // Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ (part1, part2, ...)
  let loadedEpisodes = []; // Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù„ÙŠ Ø§ØªØ­Ù…Ù‘Ù„Øª ÙØ¹Ù„Ø§Ù‹
  let currentPartIndex = 0;
  let currentEpisodeIndex = 0;

  // ğŸ“¦ ØªØ­Ù…ÙŠÙ„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨
  async function loadPartList() {
    const snapshot = await getDocs(collection(db, "episodes"));
    allParts = snapshot.docs
      .map((doc) => doc.id)
      .filter((id) => id.startsWith("part"))
      .sort((a, b) => parseInt(a.replace("part", "")) - parseInt(b.replace("part", "")));
  }

  // ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø¬Ø²Ø¡ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
  async function loadPart(partName) {
    const docRef = doc(db, "episodes", partName);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
      return docSnap.data().episodes;
    } else {
      console.warn("âŒ Ø§Ù„Ø¬Ø²Ø¡ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯:", partName);
      return [];
    }
  }

  // ğŸ“œ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù„Ù‚Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
  function renderEpisodes(episodes) {
    const container = document.getElementById("episodes");
    episodes.forEach((ep) => {
      const div = document.createElement("div");
      div.className = "episode";
      div.textContent = `${ep.title} (${ep.date})`;
      container.appendChild(div);
    });
  }

  // âš™ï¸ ØªØ­Ù…ÙŠÙ„ Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ø­Ø³Ø¨ maxItemsPerPage)
  async function loadMoreEpisodes() {
    // Ù„Ùˆ Ù…ÙÙŠØ´ Ø£Ø¬Ø²Ø§Ø¡ Ù…ØªØ¨Ù‚ÙŠØ©
    if (currentPartIndex >= allParts.length && currentEpisodeIndex === 0) {
      console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡.");
      return;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ùˆ Ù„Ø³Ù‡ Ù…Ø­Ù…Ù„Ø´
    if (loadedEpisodes.length === 0) {
      const partName = allParts[currentPartIndex];
      console.log(`ğŸ“‚ ØªØ­Ù…ÙŠÙ„ ${partName}...`);
      loadedEpisodes = await loadPart(partName);
      currentEpisodeIndex = 0;
    }

    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù„ÙŠ Ù‡ØªØªØ¹Ø±Ø¶ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙØ¹Ø©
    const start = currentEpisodeIndex;
    const end = Math.min(start + maxItemsPerPage, loadedEpisodes.length);
    const newBatch = loadedEpisodes.slice(start, end);
    renderEpisodes(newBatch);

    currentEpisodeIndex = end;

    // Ù„Ùˆ Ø®Ù„ØµÙ†Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø¯Ù‡ØŒ Ù†Ù†ØªÙ‚Ù„ Ù„Ù„ÙŠ Ø¨Ø¹Ø¯Ù‡
    if (currentEpisodeIndex >= loadedEpisodes.length) {
      currentPartIndex++;
      loadedEpisodes = [];
      currentEpisodeIndex = 0;
    }
  }

  // ğŸ“¥ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„
  await loadPartList();
  await loadMoreEpisodes();

  // âš¡ Ø­Ø¯Ø« Ø§Ù„ØªÙ…Ø±ÙŠØ± (lazy load)
  window.addEventListener("scroll", async () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 300) {
      await loadMoreEpisodes();
    }
  });
</script>

<style>
  body {
    font-family: sans-serif;
    background: #111;
    color: #fff;
  }
  .episode {
    background: #222;
    margin: 10px;
    padding: 10px;
    border-radius: 8px;
  }
</style>

<div id="episodes"></div>



</main>

<script>
    // Fetch and inject the navbar content
    fetch('navbar.html')
        .then(response => response.text())
        .then(data => document.getElementById('navbar-container').innerHTML = data)
        .catch(error => console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„:", error));
</script>
<div style="margin: 15px 0; text-align: center;">
  <script async="async" data-cfasync="false" src="//pl27400501.profitableratecpm.com/cccf85ebe49cd5752952d5b413cfb457/invoke.js"></script>
  <div id="container-cccf85ebe49cd5752952d5b413cfb457"></div>
</div>

</body>
</html>





